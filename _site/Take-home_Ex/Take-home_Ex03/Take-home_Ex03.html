<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Arya Siahaan">
<meta name="dcterms.date" content="2024-05-15">

<title>ISSS608-VAA - Take-home Exercise 3</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">ISSS608-VAA</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Hands-on Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercise">    
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html">
 <span class="dropdown-text">Hands-on Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02.html">
 <span class="dropdown-text">Hands-on Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex03/Hands-on_Ex03a.html">
 <span class="dropdown-text">Hands-on Exercise 3a</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex03/Hands-on_Ex03b.html">
 <span class="dropdown-text">Hands-on Exercise 3b</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04a.html">
 <span class="dropdown-text">Hands-on Exercise 4a</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04b.html">
 <span class="dropdown-text">Hands-on Exercise 4b</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04c.html">
 <span class="dropdown-text">Hands-on Exercise 4c</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05.html">
 <span class="dropdown-text">Hands-on Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex06/Hands-on_Ex06.html">
 <span class="dropdown-text">Hands-on Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex07/Hands-on_Ex07.html">
 <span class="dropdown-text">Hands-on Exercise 7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex08/Hands-on_Ex08a.html">
 <span class="dropdown-text">Hands-on Exercise 8a</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex08/Hands-on_Ex08b.html">
 <span class="dropdown-text">Hands-on Exercise 8b</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex08/Hands-on_Ex08c.html">
 <span class="dropdown-text">Hands-on Exercise 8c</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex09/Hands-on_Ex09.html">
 <span class="dropdown-text">Hands-on Exercise 9</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex10/Hands-on_Ex10.html">
 <span class="dropdown-text">Hands-on Exercise 10</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-class Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercise">    
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex01/In-class_Ex01.html">
 <span class="dropdown-text">In-class Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex02/In-class_Ex02.html">
 <span class="dropdown-text">In-class Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex03/In-class_Ex03.html">
 <span class="dropdown-text">In-class Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex04/In-class_Ex04.html">
 <span class="dropdown-text">In-class Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex05/In-class_Ex05a.html">
 <span class="dropdown-text">In-class Exercise 5a</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex05/In-class_Ex05b.html">
 <span class="dropdown-text">In-class Exercise 5b</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex06/In-class_Ex06a.html">
 <span class="dropdown-text">In-class Exercise 6a</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex06/In-class_Ex06b.html">
 <span class="dropdown-text">In-class Exercise 6b</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex09/In-class_Ex09.html">
 <span class="dropdown-text">In-class Exercise 9</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex10/In-class_Ex10.html">
 <span class="dropdown-text">In-class Exercise 10</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Take-home Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercise">    
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex01/Take-home_Ex01.html">
 <span class="dropdown-text">Take-home Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html">
 <span class="dropdown-text">Take-home Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex03/Take-home_Ex03.html">
 <span class="dropdown-text">Take-home Exercise 3</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-group-project" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Group Project</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-group-project">    
        <li>
    <a class="dropdown-item" href="https://vastchallenge-grp1-mc2.netlify.app/">
 <span class="dropdown-text">Group Project</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#vast-challenge-2024" id="toc-vast-challenge-2024" class="nav-link active" data-scroll-target="#vast-challenge-2024">VAST Challenge 2024</a>
  <ul class="collapse">
  <li><a href="#mini-challenge-2" id="toc-mini-challenge-2" class="nav-link" data-scroll-target="#mini-challenge-2">Mini-Challenge 2:</a></li>
  <li><a href="#getting-started" id="toc-getting-started" class="nav-link" data-scroll-target="#getting-started">Getting Started</a>
  <ul class="collapse">
  <li><a href="#loading-the-required-r-library-packages" id="toc-loading-the-required-r-library-packages" class="nav-link" data-scroll-target="#loading-the-required-r-library-packages">Loading the required R library packages</a></li>
  <li><a href="#loading-the-data" id="toc-loading-the-data" class="nav-link" data-scroll-target="#loading-the-data">Loading The Data</a></li>
  </ul></li>
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation">DATA PREPARATION</a>
  <ul class="collapse">
  <li><a href="#wrangling-and-tidying-edges-data.frame" id="toc-wrangling-and-tidying-edges-data.frame" class="nav-link" data-scroll-target="#wrangling-and-tidying-edges-data.frame">Wrangling and tidying <em>edges</em> data.frame</a></li>
  <li><a href="#initial-eda-of-mc2_edges-data.frame" id="toc-initial-eda-of-mc2_edges-data.frame" class="nav-link" data-scroll-target="#initial-eda-of-mc2_edges-data.frame">Initial EDA of mc2_edges data.frame</a></li>
  <li><a href="#further-cleaning-of-mc2_edges-data.frame" id="toc-further-cleaning-of-mc2_edges-data.frame" class="nav-link" data-scroll-target="#further-cleaning-of-mc2_edges-data.frame">Further cleaning of mc2_edges data.frame</a></li>
  <li><a href="#wrangling-and-tidying-nodes-data.frame" id="toc-wrangling-and-tidying-nodes-data.frame" class="nav-link" data-scroll-target="#wrangling-and-tidying-nodes-data.frame">Wrangling and tidying <em>nodes</em> data.frame</a></li>
  <li><a href="#initial-eda-of-mc2_nodes-data.frame" id="toc-initial-eda-of-mc2_nodes-data.frame" class="nav-link" data-scroll-target="#initial-eda-of-mc2_nodes-data.frame"><strong>Initial EDA of mc2_nodes data.frame</strong></a></li>
  <li><a href="#further-cleaning-of-mc2_nodes-data.frame" id="toc-further-cleaning-of-mc2_nodes-data.frame" class="nav-link" data-scroll-target="#further-cleaning-of-mc2_nodes-data.frame"><strong>Further Cleaning of mc2_nodes data.frame</strong></a></li>
  <li><a href="#importing-geographical-data-in-geojson-format" id="toc-importing-geographical-data-in-geojson-format" class="nav-link" data-scroll-target="#importing-geographical-data-in-geojson-format">Importing Geographical Data in GEOJSON format</a></li>
  </ul></li>
  <li><a href="#data-analysis" id="toc-data-analysis" class="nav-link" data-scroll-target="#data-analysis">DATA ANALYSIS</a>
  <ul class="collapse">
  <li><a href="#importing-edges-data" id="toc-importing-edges-data" class="nav-link" data-scroll-target="#importing-edges-data">Importing Edges Data</a></li>
  <li><a href="#extract-vessel-movement-data" id="toc-extract-vessel-movement-data" class="nav-link" data-scroll-target="#extract-vessel-movement-data">Extract Vessel Movement Data</a></li>
  <li><a href="#further-data-wrangling" id="toc-further-data-wrangling" class="nav-link" data-scroll-target="#further-data-wrangling"><strong>Further Data Wrangling</strong></a></li>
  <li><a href="#creating-vessel-trajectory-data" id="toc-creating-vessel-trajectory-data" class="nav-link" data-scroll-target="#creating-vessel-trajectory-data">Creating Vessel Trajectory Data</a></li>
  </ul></li>
  <li><a href="#lets-begin-the-investigation" id="toc-lets-begin-the-investigation" class="nav-link" data-scroll-target="#lets-begin-the-investigation">Let’s begin the investigation!</a>
  <ul class="collapse">
  <li><a href="#visualising-the-geo-temporal-patterns-of-the-vessels" id="toc-visualising-the-geo-temporal-patterns-of-the-vessels" class="nav-link" data-scroll-target="#visualising-the-geo-temporal-patterns-of-the-vessels">Visualising the Geo-Temporal Patterns of the Vessels</a></li>
  </ul></li>
  <li><a href="#reference" id="toc-reference" class="nav-link" data-scroll-target="#reference"><strong>Reference</strong></a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Take-home Exercise 3</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Arya Siahaan </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 15, 2024</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">June 30, 2024</p>
    </div>
  </div>
    
  </div>
  


</header>


<section id="vast-challenge-2024" class="level1">
<h1>VAST Challenge 2024</h1>
<section id="mini-challenge-2" class="level3">
<h3 class="anchored" data-anchor-id="mini-challenge-2">Mini-Challenge 2:</h3>
<section id="background" class="level4">
<h4 class="anchored" data-anchor-id="background">Background</h4>
<p>In Oceanus, the island’s economy thrives on the movement of seafaring vessels, particularly those operated by commercial fishing companies, indicating a healthy economic state. However, a major event has disrupted these routines: SouthSeafood Express Corp was caught engaging in illegal fishing. This scandal caused significant turmoil within the close-knit fishing community. FishEye International, a non-profit dedicated to combating illegal fishing, seeks assistance to understand the impact of this event. They have been gathering and processing data on ship movements and shipping records to create CatchNet: the Oceanus Knowledge Graph. While analysts at FishEye ensure data accuracy, they require assistance to develop analytical capabilities for this data.</p>
</section>
<section id="tasks-and-questions" class="level4">
<h4 class="anchored" data-anchor-id="tasks-and-questions">Tasks and Questions:</h4>
<p>FishEye analysts require assistance in performing geographic and temporal analysis of the CatchNet data to prevent future instances of illegal fishing. The task involves developing innovative visual analytics tools and workflows designed to identify and understand signatures of various behaviors. One key objective is to visualize the signature of SouthSeafood Express Corp’s illegal activities. Additionally, there is a need to create a workflow capable of detecting other instances of illegal behavior within the data. These efforts are crucial for enhancing FishEye’s ability to monitor and combat illegal fishing effectively. This exercise will attempt to address Question 1 and Question 3 of this challenge.</p>
<section id="question-1" class="level5">
<h5 class="anchored" data-anchor-id="question-1">Question 1</h5>
<p>FishEye analysts have long wanted to better understand the flow of commercially caught fish through Oceanus’s many ports. But as they were loading data into CatchNet, they discovered they had purchased the wrong port records. They wanted to get the ship off-load records, but they instead got the port-exit records (essentially trucks/trains leaving the port area). Port exit records do not include which vessel that delivered the products. Given this limitation, develop a visualization system to associate vessels with their probable cargos. Which vessels deliver which products and when? What are the seasonal trends and anomalies in the port exit records?</p>
</section>
<section id="question-3" class="level5">
<h5 class="anchored" data-anchor-id="question-3">Question 3</h5>
<p>To support further Fisheye investigations, develop visual analytics workflows that allow you to discover other vessels engaging in behaviors similar to SouthSeafood Express Corp’s illegal activities? Provide visual evidence of the similarities.</p>
</section>
</section>
</section>
<section id="getting-started" class="level2">
<h2 class="anchored" data-anchor-id="getting-started">Getting Started</h2>
<section id="loading-the-required-r-library-packages" class="level3">
<h3 class="anchored" data-anchor-id="loading-the-required-r-library-packages">Loading the required R library packages</h3>
<p>For the purpose of this exercise, several R packages will be used to perform the following tasks:</p>
<ul>
<li><p>Importing graph data in json file format into R</p></li>
<li><p>Extracting the nodes and edges (also known as links) from imported graph data.</p></li>
<li><p>Wrangling text data type.</p></li>
<li><p>Importing geographical data in geojson file format into R,</p></li>
<li><p>Importing geographical data in ESRI shapefile format into R,</p></li>
<li><p>Extracting movement data from the edges table of a knowledge graph,</p></li>
<li><p>Deriving a trajectory data from a movement data, and</p></li>
<li><p>Visualising trajectory data to reveal geo-temporal patterns.</p></li>
</ul>
<p>The following code chunk utilises the <a href="https://www.rdocumentation.org/packages/pacman/versions/0.5.1/topics/p_load"><code>p_load()</code></a> function from the <a href="https://github.com/trinker/pacman">pacman</a> package to ensure that the necessary packages are available in the R environment. If the packages are already installed on the computer, <a href="https://www.rdocumentation.org/packages/pacman/versions/0.5.1/topics/p_load"><code>p_load()</code></a> will load them. If they are not installed, it will first install them and then load them into the R environment.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, jsonlite, DataExplorer,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               lubridate, ggplot2, tidygraph,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>               ggraph, igraph, sf, skimr) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="loading-the-data" class="level3">
<h3 class="anchored" data-anchor-id="loading-the-data">Loading The Data</h3>
<p>The dataset for this exercise is available for download at the <a href="https://vast-challenge.github.io/2024/index.html">Vast Challenge 2024</a>. As I undertake Mini-Challenge 2, I will utilize the dataset provided in the form of a JSON file named <code>mc2.json</code>.</p>
<p>In the code chunk below, <code>fromJSON()</code> of <strong>jsonlite</strong> package is used to import <code>mc2.json</code> file into R and save the output object.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>mc2_data <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/mc2.json"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The output is called <em><code>mc2_data</code></em>. It is a large list R object.</p>
</section>
</section>
<section id="data-preparation" class="level2">
<h2 class="anchored" data-anchor-id="data-preparation">DATA PREPARATION</h2>
<section id="wrangling-and-tidying-edges-data.frame" class="level3">
<h3 class="anchored" data-anchor-id="wrangling-and-tidying-edges-data.frame">Wrangling and tidying <em>edges</em> data.frame</h3>
<section id="extracting-edges-and-removing-duplicates" class="level4">
<h4 class="anchored" data-anchor-id="extracting-edges-and-removing-duplicates">Extracting <em>edges</em> and removing duplicates</h4>
<p>The code chunk below extracts the <em>links</em> data.frame from <code>mc2_data</code> and saves it as a tibble data.frame called <code>mc2_edges</code>. The <code>distinct()</code> function is used to remove duplicates.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Wrangling and tidying edges</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>mc2_edges <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(mc2_data<span class="sc">$</span>links) <span class="sc">%&gt;%</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, <code>glimpse()</code> of <strong>dplyr</strong> package will be used to reveal the structure of <code>mc2_edges</code> tibble data table</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(mc2_edges)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 271,643
Columns: 17
$ type                &lt;chr&gt; "Event.TransportEvent.TransponderPing", "Event.Tra…
$ time                &lt;chr&gt; "2035-09-16T04:06:48.185987", "2035-09-20T05:21:33…
$ dwell               &lt;dbl&gt; 115074.79, 412706.32, 286092.88, 327623.95, 243225…
$ `_last_edited_by`   &lt;chr&gt; "Olokun Daramola", "Melinda Manning", "Olokun Dara…
$ `_date_added`       &lt;chr&gt; "2035-09-16T00:59:46.300100", "2035-09-22T02:37:37…
$ `_last_edited_date` &lt;chr&gt; "2035-09-16T00:59:46.300100", "2035-09-22T02:37:37…
$ `_raw_source`       &lt;chr&gt; "Oceanus Vessel Locator System", "Oceanus Vessel L…
$ `_algorithm`        &lt;chr&gt; "OVLS-Catch&amp;Hook", "OVLS-Catch&amp;Hook", "OVLS-Catch&amp;…
$ source              &lt;chr&gt; "City of Haacklee", "City of Haacklee", "City of H…
$ target              &lt;chr&gt; "perchplundererbc0", "perchplundererbc0", "perchpl…
$ key                 &lt;int&gt; 0, 1, 2, 3, 4, 5, 6, 7, 8, 0, 1, 2, 3, 4, 5, 6, 7,…
$ date                &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ data_author         &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ aphorism            &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ holiday_greeting    &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ wisdom              &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `saying of the sea` &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Observation">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Observation
</div>
</div>
<div class="callout-body-container callout-body">
<p>From the table above, the following data issues can be identified:</p>
<ul>
<li><p>Columns with date and time data type are not in the correct format.</p></li>
<li><p>The column <code>type</code> also seems to contain three different types of information, namely: ‘Event’, ‘TransportEvent’, ‘TransponderPing’.</p></li>
</ul>
</div>
</div>
</section>
<section id="correcting-time-and-date-data-type-from-mc2_edges-data.frame" class="level4">
<h4 class="anchored" data-anchor-id="correcting-time-and-date-data-type-from-mc2_edges-data.frame"><strong>Correcting time and date data type from mc2_edges data.frame</strong></h4>
<p>In the code chunk below, <code>as_datetime()</code> of <strong>lubridate</strong> package is used to convert fields with character date into <strong>POSIXt</strong> format.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>mc2_edges<span class="sc">$</span>time <span class="ot">&lt;-</span> <span class="fu">as_datetime</span>(mc2_edges<span class="sc">$</span>time)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>mc2_edges<span class="sc">$</span><span class="st">"date"</span> <span class="ot">&lt;-</span> <span class="fu">as_datetime</span>(<span class="st">"mc2_edges$date"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, <code>glimpse()</code> will be used again to confirm if the process have been performed correctly.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(mc2_edges)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 271,643
Columns: 17
$ type                &lt;chr&gt; "Event.TransportEvent.TransponderPing", "Event.Tra…
$ time                &lt;dttm&gt; 2035-09-16 04:06:48, 2035-09-20 05:21:33, 2035-09…
$ dwell               &lt;dbl&gt; 115074.79, 412706.32, 286092.88, 327623.95, 243225…
$ `_last_edited_by`   &lt;chr&gt; "Olokun Daramola", "Melinda Manning", "Olokun Dara…
$ `_date_added`       &lt;chr&gt; "2035-09-16T00:59:46.300100", "2035-09-22T02:37:37…
$ `_last_edited_date` &lt;chr&gt; "2035-09-16T00:59:46.300100", "2035-09-22T02:37:37…
$ `_raw_source`       &lt;chr&gt; "Oceanus Vessel Locator System", "Oceanus Vessel L…
$ `_algorithm`        &lt;chr&gt; "OVLS-Catch&amp;Hook", "OVLS-Catch&amp;Hook", "OVLS-Catch&amp;…
$ source              &lt;chr&gt; "City of Haacklee", "City of Haacklee", "City of H…
$ target              &lt;chr&gt; "perchplundererbc0", "perchplundererbc0", "perchpl…
$ key                 &lt;int&gt; 0, 1, 2, 3, 4, 5, 6, 7, 8, 0, 1, 2, 3, 4, 5, 6, 7,…
$ date                &lt;dttm&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ data_author         &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ aphorism            &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ holiday_greeting    &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ wisdom              &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `saying of the sea` &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Observation">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Observation
</div>
</div>
<div class="callout-body-container callout-body">
<p>As we can see now, the <code>time</code> and <code>date</code> columns have been converted to <strong>datetime</strong> format.</p>
</div>
</div>
</section>
<section id="splitting-words" class="level4">
<h4 class="anchored" data-anchor-id="splitting-words"><strong>Splitting words</strong></h4>
<p><img src="images/clipboard-3479349286.png" class="img-fluid"></p>
<p>From the table above, we can see that the text in the <code>type</code> column is not tidy. I will tidy the <code>type</code> column by splitting it into three new separate columns called <code>event1</code>, <code>event2</code>, and <code>event3</code>. However, I will only keep the columns containing the values ‘TransportEvent’ and ‘TransponderPing’, which will be <code>event2</code> and <code>event3</code>.</p>
</section>
<section id="splitting-and-tidying-the-type-column-from-mc2_edges-data.frame" class="level4">
<h4 class="anchored" data-anchor-id="splitting-and-tidying-the-type-column-from-mc2_edges-data.frame">Splitting and Tidying the ‘type’ Column from mc2_edges data.frame</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>word_list <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(mc2_edges<span class="sc">$</span>type, <span class="st">"</span><span class="sc">\\</span><span class="st">."</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># The code chunk below will be used to find the maximum number of elements in any split</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>max_elements <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">lengths</span>(word_list)) <span class="co">#to find the maximum number of elements in any split</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co">#The code chunk below will be used to pad shorter splits with NA values to make them all the same length.</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>word_list_padded <span class="ot">&lt;-</span> <span class="fu">lapply</span>(word_list, </span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span>(x) <span class="fu">c</span>(x, <span class="fu">rep</span>(<span class="cn">NA</span>, max_elements <span class="sc">-</span> <span class="fu">length</span>(x)))) <span class="co">#to pad shorter splits with NA values to make them all the same length.</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>word_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, word_list_padded)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(word_df) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"event"</span>, <span class="dv">1</span><span class="sc">:</span>max_elements)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Since the output above is a matrix, the code chunk below is used to convert word_df into a tibble data.frame.</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>word_df <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(word_df) <span class="sc">%&gt;%</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(event2, event3)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="co"># The code chunk below appends the extracted columns back to mc2_edges tibble data.frame</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>mc2_edges <span class="ot">&lt;-</span> mc2_edges <span class="sc">%&gt;%</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(word_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This code splits the <code>type</code> column into multiple components, pads shorter entries with NAs, and integrates them back into the <code>mc2_edges</code> data.frame as new columns.</p>
<p><img src="images/clipboard-2806146328.png" class="img-fluid"></p>
<div class="callout callout-style-default callout-tip callout-titled" title="Observation">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Observation
</div>
</div>
<div class="callout-body-container callout-body">
<p>As we can see here, two new columns, <code>event2</code> and <code>event3</code>, have been created and appended to the <code>mc2_edges</code> data.frame.</p>
</div>
</div>
</section>
</section>
<section id="initial-eda-of-mc2_edges-data.frame" class="level3">
<h3 class="anchored" data-anchor-id="initial-eda-of-mc2_edges-data.frame">Initial EDA of mc2_edges data.frame</h3>
<p>After cleaning and preparing the <code>mc2_edges</code> data.frame, I want to understand how the newly formed structure looks. Let’s make use of the <strong>DataExplorer</strong> package to visualize it.</p>
<p>The code below uses the <code>plot_intro</code> function, which is part of the <strong>DataExplorer</strong> package. This function provides a high-level summary of the <code>mc2_edges</code> data.frame, offering insights into its structure and content.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">The plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">The code</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p><img src="images/clipboard-2055116904.png" class="img-fluid"></p>
<p><img src="images/clipboard-1180112888.png" class="img-fluid"></p>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot introduction of the data</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_intro</span>(mc2_edges, <span class="at">title =</span> <span class="st">"Introduction of mc2_edges Data"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>The <code>plot_str</code> function below generates a plot that visualizes the structure of <code>mc2_edges</code> data.frame, showing the relationships between different columns and their types.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">The plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">The code</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p><img src="images/clipboard-2619173514.png" class="img-fluid"></p>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate and display the data structure plot</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_str</span>(mc2_edges)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>The <code>plot_missing</code> function below generates a visualization that helps to identify and understand the distribution of missing values within <code>mc2_edges</code> data.frame.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">The plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">The code</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<p><img src="images/clipboard-299140884.png" class="img-fluid"></p>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot missing values</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_missing</span>(mc2_edges, <span class="at">title =</span> <span class="st">"Missing Values in mc2_edges Data"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="further-cleaning-of-mc2_edges-data.frame" class="level3">
<h3 class="anchored" data-anchor-id="further-cleaning-of-mc2_edges-data.frame">Further cleaning of mc2_edges data.frame</h3>
<p>After the initial EDA, I will remove columns from <code>mc2_edges</code> data.frame that are unnecessary to complete Mini-Challenge 2.</p>
<section id="dropping-unnecessary-columns-from-mc2_edges-data.frame" class="level4">
<h4 class="anchored" data-anchor-id="dropping-unnecessary-columns-from-mc2_edges-data.frame">Dropping unnecessary columns from mc2_edges data.frame</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>mc2_edges_cleaned <span class="ot">&lt;-</span> mc2_edges <span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="st">`</span><span class="at">type</span><span class="st">`</span>, <span class="st">`</span><span class="at">_last_edited_by</span><span class="st">`</span>, <span class="st">`</span><span class="at">_date_added</span><span class="st">`</span>, <span class="st">`</span><span class="at">_last_edited_date</span><span class="st">`</span>, <span class="st">`</span><span class="at">_raw_source</span><span class="st">`</span>, <span class="st">`</span><span class="at">_algorithm</span><span class="st">`</span>, <span class="st">`</span><span class="at">key</span><span class="st">`</span>,  <span class="st">`</span><span class="at">data_author</span><span class="st">`</span>, <span class="st">`</span><span class="at">aphorism</span><span class="st">`</span>, <span class="st">`</span><span class="at">holiday_greeting</span><span class="st">`</span>, <span class="st">`</span><span class="at">wisdom</span><span class="st">`</span>, <span class="st">`</span><span class="at">saying of the sea</span><span class="st">`</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The code above removes unnecessary columns from <code>mc2_edges</code> that are not needed for analysis, and then assigns the cleaned-up version to a new data.frame called <code>mc2_edges_cleaned</code>.</p>
<p>Next, let’s use <code>glimpse()</code> to check what <code>mc2_edges_cleaned</code> looks like.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(mc2_edges_cleaned)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 271,643
Columns: 7
$ time   &lt;dttm&gt; 2035-09-16 04:06:48, 2035-09-20 05:21:33, 2035-09-28 04:31:47,…
$ dwell  &lt;dbl&gt; 115074.79, 412706.32, 286092.88, 327623.95, 243225.35, 109564.2…
$ source &lt;chr&gt; "City of Haacklee", "City of Haacklee", "City of Haacklee", "Ci…
$ target &lt;chr&gt; "perchplundererbc0", "perchplundererbc0", "perchplundererbc0", …
$ date   &lt;dttm&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ event2 &lt;chr&gt; "TransportEvent", "TransportEvent", "TransportEvent", "Transpor…
$ event3 &lt;chr&gt; "TransponderPing", "TransponderPing", "TransponderPing", "Trans…</code></pre>
</div>
</div>
<p>Before moving to the next task, it would be wise to save the tidied <code>mc2_edges_cleaned</code> data.frame into a physical file for future use. By doing so, repeating the steps above will not be necessary.</p>
<p>The code chunk below will be used to save <code>mc2_edges_cleaned</code> into R <strong>rds</strong> file format.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Since the file will be saved in the <code>rds</code> sub-folder within the <code>data</code> folder, ensure that the <code>rds</code> folder exists. If it does not, it needs to be created first.</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(mc2_edges_cleaned, <span class="st">"data/rds/mc2_edges_cleaned.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This completes the data preparation process for the <em>links</em> data.frame of <code>mc2_data</code>, which is now stored in the <code>mc2_edges_cleaned</code> data.frame and saved as a physical <code>mc2_edges_cleaned.rds</code> file.</p>
<p>The next step is to clean and prepare the <em>nodes</em> data.frame of <code>mc2_data</code>.</p>
</section>
</section>
<section id="wrangling-and-tidying-nodes-data.frame" class="level3">
<h3 class="anchored" data-anchor-id="wrangling-and-tidying-nodes-data.frame">Wrangling and tidying <em>nodes</em> data.frame</h3>
<section id="extracting-nodes-and-removing-duplicates" class="level4">
<h4 class="anchored" data-anchor-id="extracting-nodes-and-removing-duplicates">Extracting <em>nodes</em> and removing duplicates</h4>
<p>The code chunk below extracts the <em>nodes</em> data.frame from <code>mc2_data</code>, parses it as a tibble data.frame called <code>mc2_nodes</code>, and removes duplicate rows using the <code>distinct()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>mc2_nodes <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(mc2_data<span class="sc">$</span>nodes) <span class="sc">%&gt;%</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, the code chunk below uses the <code>glimpse()</code> function to reveal the data structure of the <code>mc2_nodes</code> tibble data.frame.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(mc2_nodes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 5,637
Columns: 20
$ type                 &lt;chr&gt; "Entity.Commodity.Fish", "Entity.Commodity.Fish",…
$ `_last_edited_by`    &lt;chr&gt; "Clepper Jessen", "Clepper Jessen", "Haenyeo Hyun…
$ `_date_added`        &lt;chr&gt; "2033-09-04T00:00:00", "2034-01-21T00:00:00", "20…
$ `_last_edited_date`  &lt;chr&gt; "2035-01-25T00:00:00", "2035-01-04T00:00:00", "20…
$ `_raw_source`        &lt;chr&gt; "", "", "", "", "", "", "", "", "", "", "Oceanus:…
$ `_algorithm`         &lt;chr&gt; "", "", "", "", "", "", "", "", "", "", "", "", "…
$ name                 &lt;chr&gt; "Cod/Gadus n.specificatae", "Birdseye/Pisces frig…
$ id                   &lt;chr&gt; "gadusnspecificatae4ba", "piscesfrigus900", "pisc…
$ Name                 &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, "Haacklee…
$ Description          &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ Activities           &lt;list&gt; &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;, …
$ kind                 &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, "city", "…
$ qty_tons             &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ date                 &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ flag_country         &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ company              &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ tonnage              &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ length_overall       &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ style                &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ fish_species_present &lt;list&gt; &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;, …</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>From the table above, the following data issues can be identified:</p>
<ul>
<li><p>The column <code>date</code> data type is not in the correct format.</p></li>
<li><p>The values in Activities and fish_species_present fields are in <strong>list</strong> data type, which will affect the ability to process and to analyse the data.</p></li>
<li><p>As shown in the screenshot below, some values in the Activities field are not ready to be analyse without further tidying (i.e.&nbsp;removing c(““)).</p></li>
</ul>
</div>
</div>
</section>
<section id="correcting-date-data-type-from-mc2_nodes-data.frame" class="level4">
<h4 class="anchored" data-anchor-id="correcting-date-data-type-from-mc2_nodes-data.frame"><strong>Correcting date data type from mc2_nodes data.frame</strong></h4>
<p>In the code chunk below, <code>as_datetime()</code> of <strong>lubridate</strong> package is used to convert date fields with character date into <strong>POSIXt</strong> format.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>mc2_nodes<span class="sc">$</span>date <span class="ot">&lt;-</span> <span class="fu">as_datetime</span>(mc2_nodes<span class="sc">$</span>date)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, <code>glimpse()</code> will be used again to confirm if the process have been performed correctly.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(mc2_nodes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 5,637
Columns: 20
$ type                 &lt;chr&gt; "Entity.Commodity.Fish", "Entity.Commodity.Fish",…
$ `_last_edited_by`    &lt;chr&gt; "Clepper Jessen", "Clepper Jessen", "Haenyeo Hyun…
$ `_date_added`        &lt;chr&gt; "2033-09-04T00:00:00", "2034-01-21T00:00:00", "20…
$ `_last_edited_date`  &lt;chr&gt; "2035-01-25T00:00:00", "2035-01-04T00:00:00", "20…
$ `_raw_source`        &lt;chr&gt; "", "", "", "", "", "", "", "", "", "", "Oceanus:…
$ `_algorithm`         &lt;chr&gt; "", "", "", "", "", "", "", "", "", "", "", "", "…
$ name                 &lt;chr&gt; "Cod/Gadus n.specificatae", "Birdseye/Pisces frig…
$ id                   &lt;chr&gt; "gadusnspecificatae4ba", "piscesfrigus900", "pisc…
$ Name                 &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, "Haacklee…
$ Description          &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ Activities           &lt;list&gt; &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;, …
$ kind                 &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, "city", "…
$ qty_tons             &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ date                 &lt;dttm&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
$ flag_country         &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ company              &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ tonnage              &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ length_overall       &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ style                &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ fish_species_present &lt;list&gt; &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;, …</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Observation">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Observation
</div>
</div>
<div class="callout-body-container callout-body">
<p>As we can see now, the time and date columns have been converted to datetime format.</p>
</div>
</div>
<p>There are two more additional data issues can be observed. They are:</p>
<p>The values in <code>Activities</code> and <code>fish_species_present</code> columns are in list data type, which will affect the ability to process and to analyze the data.</p>
<p>As shown in the screenshot below, some values in the <code>Activities</code> and <code>fish_species_present</code>column are not ready to be analyze without further tidying (i.e.&nbsp;removing c(““)).</p>
<p><img src="images/clipboard-2425530968.png" class="img-fluid"></p>
</section>
<section id="tidying-text-field" class="level4">
<h4 class="anchored" data-anchor-id="tidying-text-field">Tidying Text Field</h4>
<p>In the code chunk below, <code>mutate()</code> from <code>dplyr</code> and <code>gsub()</code> from Base R are used to perform the data tidying task.</p>
<p>This cleans up the <code>Activities</code> and <code>fish_species_present</code> columns by removing unnecessary characters.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>mc2_nodes <span class="ot">&lt;-</span> mc2_nodes <span class="sc">%&gt;%</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Activities =</span> <span class="fu">gsub</span>(<span class="st">"c[(]"</span>, <span class="st">""</span>, Activities)) <span class="sc">%&gt;%</span> </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Activities =</span> <span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\"</span><span class="st">"</span>, <span class="st">""</span>, Activities)) <span class="sc">%&gt;%</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Activities =</span> <span class="fu">gsub</span>(<span class="st">"[)]"</span>, <span class="st">""</span>, Activities)) </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>mc2_nodes <span class="ot">&lt;-</span> mc2_nodes <span class="sc">%&gt;%</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fish_species_present =</span> <span class="fu">gsub</span>(<span class="st">"c[(]"</span>, <span class="st">""</span>, fish_species_present)) <span class="sc">%&gt;%</span> </span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fish_species_present =</span> <span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\"</span><span class="st">"</span>, <span class="st">""</span>, fish_species_present)) <span class="sc">%&gt;%</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fish_species_present =</span> <span class="fu">gsub</span>(<span class="st">"[)]"</span>, <span class="st">""</span>, fish_species_present)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>After executing the code chunk above, we can see from the screenshot below, that the text field in <code>Activities</code> and <code>fish_species_present</code> columns have been tidied.</p>
<p><img src="images/clipboard-3517877848.png" class="img-fluid"></p>
</section>
</section>
<section id="initial-eda-of-mc2_nodes-data.frame" class="level3">
<h3 class="anchored" data-anchor-id="initial-eda-of-mc2_nodes-data.frame"><strong>Initial EDA of mc2_nodes data.frame</strong></h3>
<p>Now, let’s use the DataExplorer package again to visualize the <code>mc2_nodes</code> data.frame in a similar manner as was done above for the <code>mc2_edges</code> data.frame.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">The plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">The code</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<p><img src="images/clipboard-4088556349.png" class="img-fluid"></p>
<p><img src="images/clipboard-290209426.png" class="img-fluid"></p>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot introduction of the data</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_intro</span>(mc2_nodes, <span class="at">title =</span> <span class="st">"Introduction of mc2_nodes Data"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>The <code>plot_str</code> function below generates a plot that visualizes the structure of <code>mc2_nodes</code> data.frame, showing the relationships between different columns and their types.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">The plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">The code</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<p><img src="images/clipboard-1740825281.png" class="img-fluid"></p>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate and display the data structure plot</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_str</span>(mc2_nodes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>The <code>plot_missing</code> function below generates a visualization that helps to identify and understand the distribution of missing values within <code>mc2_nodes</code> data.frame.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">The plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">The code</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<p><img src="images/clipboard-1008176763.png" class="img-fluid"></p>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot missing values</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_missing</span>(mc2_nodes, <span class="at">title =</span> <span class="st">"Missing Values in mc2_nodes Data"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="further-cleaning-of-mc2_nodes-data.frame" class="level3">
<h3 class="anchored" data-anchor-id="further-cleaning-of-mc2_nodes-data.frame"><strong>Further Cleaning of mc2_nodes data.frame</strong></h3>
<p>After the initial EDA, I will remove columns from <code>mc2_nodes</code> data.frame that are unnecessary to complete Mini-Challenge 2.</p>
<section id="dropping-unnecessary-columns-from-mc2_nodes-data.frame" class="level4">
<h4 class="anchored" data-anchor-id="dropping-unnecessary-columns-from-mc2_nodes-data.frame">Dropping unnecessary Columns from mc2_nodes data.frame</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>mc2_nodes_cleaned <span class="ot">&lt;-</span> mc2_nodes <span class="sc">%&gt;%</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="st">`</span><span class="at">_last_edited_by</span><span class="st">`</span>, <span class="st">`</span><span class="at">_date_added</span><span class="st">`</span>, <span class="st">`</span><span class="at">_last_edited_date</span><span class="st">`</span>, <span class="st">`</span><span class="at">_raw_source</span><span class="st">`</span>, <span class="st">`</span><span class="at">_algorithm</span><span class="st">`</span>, <span class="st">`</span><span class="at">style</span><span class="st">`</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The code above removes unnecessary columns from <code>mc2_nodes</code> that are not needed for analysis, and then assigns the cleaned-up version to a new data.frame called <code>mc2_nodes_cleaned</code>.</p>
<p>Next, let’s use <code>glimpse()</code> to check what <code>mc2_nodes_cleaned</code> looks like.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(mc2_nodes_cleaned)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 5,637
Columns: 14
$ type                 &lt;chr&gt; "Entity.Commodity.Fish", "Entity.Commodity.Fish",…
$ name                 &lt;chr&gt; "Cod/Gadus n.specificatae", "Birdseye/Pisces frig…
$ id                   &lt;chr&gt; "gadusnspecificatae4ba", "piscesfrigus900", "pisc…
$ Name                 &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, "Haacklee…
$ Description          &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ Activities           &lt;chr&gt; "NULL", "NULL", "NULL", "NULL", "NULL", "NULL", "…
$ kind                 &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, "city", "…
$ qty_tons             &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ date                 &lt;dttm&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
$ flag_country         &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ company              &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ tonnage              &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ length_overall       &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ fish_species_present &lt;chr&gt; "NULL", "NULL", "NULL", "NULL", "NULL", "NULL", "…</code></pre>
</div>
</div>
<p>The tidied mc2_nodes_cleaned data.frame will then be saved into a physical file for future use. By doing so, repeating the steps above will not be necessary.</p>
<p>The code chunk below will be used to save mc2_nodes_cleaned into R rds file format.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(mc2_nodes_cleaned, <span class="st">"data/rds/mc2_nodes_cleaned.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This completes the data preparation process for the <em>nodes</em> data.frame of <code>mc2_data</code>, which is now stored in the <code>mc2_nodes_cleaned</code> data.frame and saved as a physical <code>mc2_nodes_cleaned.rds</code> file.</p>
</section>
</section>
<section id="importing-geographical-data-in-geojson-format" class="level3">
<h3 class="anchored" data-anchor-id="importing-geographical-data-in-geojson-format">Importing Geographical Data in GEOJSON format</h3>
<p>Next I need to import geographical data. The data is in the form of GEOJSON file. GEOJSON is an open standard format designed for representing simple geographical features, along with their non-spatial attributes. It is based on the JSON format. I will import this using the <code>sf</code> package.</p>
<p>In the code chunk below, <code>st_read()</code> of <strong>sf</strong> package is used to import a geographical file in <a href="https://en.wikipedia.org/wiki/GeoJSON">geojson</a> format into R.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>oceanusgeography <span class="ot">=</span> <span class="fu">st_read</span>(<span class="st">"data/OceanusGeography.geojson"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">4326</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `OceanusGeography' from data source 
  `C:\aryasiahaan\ISSS608-VAA\Take-home_Ex\Take-home_Ex03\data\OceanusGeography.geojson' 
  using driver `GeoJSON'
Simple feature collection with 29 features and 7 fields
Geometry type: GEOMETRY
Dimension:     XY
Bounding box:  xmin: -167.0654 ymin: 38.07452 xmax: -163.2723 ymax: 40.67775
Geodetic CRS:  WGS 84</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Thing to learn from the code chunk above">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Thing to learn from the code chunk above
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>st_transform()</code> is used to assign wgs84 (i.e.&nbsp;4326) coordinates system to the output object.</p>
</div>
</div>
<p>The output R object (i.e.&nbsp;oceanusgeography) is an sf data.frame as shown below. Actually sf stand for simple feature.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(oceanusgeography)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "sf"         "data.frame"</code></pre>
</div>
</div>
<p>Next, <code>glimpse()</code> is used to display the structure of <em>oceanusgeography</em> sf data.frame.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(oceanusgeography)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 29
Columns: 8
$ Name                 &lt;chr&gt; "Suna Island", "Thalassa Retreat", "Makara Shoal"…
$ Description          &lt;chr&gt; "Large island of Oceanus", "Smaller island of Oce…
$ X.note               &lt;chr&gt; "Suna is 'sand' or 'gritty' in Japanese", "Thalas…
$ type                 &lt;chr&gt; "Entity.Location.Region", "Entity.Location.Region…
$ X.Kind               &lt;chr&gt; "Island", "Island", "Island", "Island", "Fishing …
$ Activities           &lt;list&gt; "Residential", "Residential", "Recreation", &lt;"To…
$ fish_species_present &lt;list&gt; &lt;&gt;, &lt;&gt;, &lt;&gt;, &lt;&gt;, &lt;"Cod/Gadus n.specificatae", "Bi…
$ geometry             &lt;GEOMETRY [°]&gt; MULTIPOLYGON (((-166.0111 3..., MULTIPOL…</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The geometry column indicate the simple feature geometry is multipolygon. However, if the data.frame is examined closely, we can see that the geographical data are captured in polygon and point features.</p>
</div>
</div>
<section id="visualising-geographical-data-with-ggplot2" class="level4">
<h4 class="anchored" data-anchor-id="visualising-geographical-data-with-ggplot2">Visualising Geographical Data with ggplot2</h4>
<p>It is always a good practice to visualize the sf data.frame in a map.</p>
<p>In the code chunk below, geom_sf() of ggplot2 package is used to plot the sf data.frame in R.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> oceanusgeography) <span class="sc">+</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Before moving on to next section, let’s save oceanusgeography into rds format for future use by using the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(oceanusgeography, <span class="st">"data/rds/oceanusgeography.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This completes the data preparation process for the <em><code>oceanusgeography</code></em> data.frame, which is now stored in the <code>oceanusgeography</code> data.frame and saved as a physical <code>oceanusgeography.rds</code> file.</p>
</section>
<section id="importing-geographical-data-in-esri-shapefile-format" class="level4">
<h4 class="anchored" data-anchor-id="importing-geographical-data-in-esri-shapefile-format">Importing Geographical Data in ESRI shapefile format</h4>
<p>In the code chunk below, <code>st_read()</code> of <strong>sf</strong> package is used to import a geographical file in <a href="#0">ESRI shapefile</a> format into R.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>oceanuslocations <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/shp"</span>,</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">layer =</span> <span class="st">"Oceanus Geography"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `Oceanus Geography' from data source 
  `C:\aryasiahaan\ISSS608-VAA\Take-home_Ex\Take-home_Ex03\data\shp' 
  using driver `ESRI Shapefile'
Simple feature collection with 27 features and 7 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: -167.0654 ymin: 38.07452 xmax: -163.2723 ymax: 40.67775
Geodetic CRS:  WGS 84</code></pre>
</div>
</div>
<p>Next <code>class()</code> is used verify if the <em><code>oceanuslocations</code></em> is indeed in sf data.frame.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(oceanuslocations)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "sf"         "data.frame"</code></pre>
</div>
</div>
<p>Similarly, <code>glimpse()</code> is used to reveal the structure of <em><code>oceanuslocation</code></em>s data.frame.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(oceanuslocations)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 27
Columns: 8
$ Name       &lt;chr&gt; "Haacklee", "Port Grove", "Lomark", "Himark", "Paackland", …
$ Descriptio &lt;chr&gt; NA, NA, NA, NA, NA, "Adimistrative seat of Oceanus", NA, NA…
$ X.note     &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
$ Activities &lt;chr&gt; "Tourism,Local shipping", "Tourism,Research", "Deep sea fis…
$ type       &lt;chr&gt; "Entity.Location.City", "Entity.Location.City", "Entity.Loc…
$ X.Kind     &lt;chr&gt; "city", "city", "city", "city", "city", "city", "city", "bu…
$ fish_speci &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
$ geometry   &lt;POINT [°]&gt; POINT (-165.6908 39.03215), POINT (-165.8855 39.10005…</code></pre>
</div>
</div>
<p>Let’s visualize the geographical data by using <code>geom_sf()</code> of ggplot2 as shown in the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> oceanuslocations) <span class="sc">+</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Before moving on to the next section, the code chunk below is used to save <em>oceanuslocations</em> into an rds file format.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(oceanuslocations, </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"data/rds/oceanuslocations.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This completes the data preparation process for the <em>oceanuslocations</em>, which is now stored in the <code>oceanuslocations</code> data.frame and saved as a physical <code>oceanuslocations.rds</code> file.</p>
</section>
</section>
</section>
<section id="data-analysis" class="level2">
<h2 class="anchored" data-anchor-id="data-analysis">DATA ANALYSIS</h2>
<p>After completing the data preparation process, the next step is to perform the analysis required to complete Mini-Challenge 2. From the background information above, we know that “SouthSeafood Express Corp” has been caught fishing illegally. Now, let’s see what we can discover from the available data regarding their illegal behavior.</p>
<section id="importing-edges-data" class="level3">
<h3 class="anchored" data-anchor-id="importing-edges-data">Importing Edges Data</h3>
<p>Now it is time to bring mc2_edges_cleaned.rds into R</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>mc2_edges_cleaned <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/mc2_edges_cleaned.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, <code>unique()</code> is used to list the unique classes in <em>event3</em> column of <em>mc2_edges</em> data.frame.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(mc2_edges_cleaned<span class="sc">$</span>event3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "TransponderPing" NA               </code></pre>
</div>
</div>
<p>The output above shows that there are two unique classes in the event3. They are: <em>TransponderPing</em> and NA.</p>
</section>
<section id="extract-vessel-movement-data" class="level3">
<h3 class="anchored" data-anchor-id="extract-vessel-movement-data">Extract Vessel Movement Data</h3>
<p>The code chunk below is used to extract vessel movement data based on TransponderPing from mc2_edges.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Thing to learn from the code chunk above">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Thing to learn from the code chunk above
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p><code>filter()</code> is used to select records with event3 is TransponderPing, and</p></li>
<li><p><code>select()</code> is used to fields that are needed to be saved</p></li>
</ul>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>vessel_movement_data <span class="ot">&lt;-</span> mc2_edges_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(event3 <span class="sc">==</span> <span class="st">"TransponderPing"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(time, dwell, source, target)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, unique() is used to list unique classes in source field.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(vessel_movement_data<span class="sc">$</span>source)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "City of Haacklee"        "City of Lomark"         
 [3] "City of Himark"          "City of Paackland"      
 [5] "City of South Paackland" "City of Port Grove"     
 [7] "Exit West"               "Nav 3"                  
 [9] "Nav D"                   "Nav B"                  
[11] "Nav A"                   "Nav C"                  
[13] "Nav 2"                   "Nav 1"                  
[15] "Exit East"               "Exit South"             
[17] "Exit North"              "Nav E"                  
[19] "Cod Table"               "Ghoti Preserve"         
[21] "Wrasse Beds"             "Nemo Reef"              
[23] "Don Limpet Preserve"     "Tuna Shelf"             </code></pre>
</div>
</div>
<p>as well as oceanuslocation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(oceanuslocations<span class="sc">$</span>Name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Haacklee"            "Port Grove"          "Lomark"             
 [4] "Himark"              "Paackland"           "Centralia"          
 [7] "South Paackland"     "Exit West"           "Nav 3"              
[10] "Nav D"               "Nav B"               "Nav A"              
[13] "Nav C"               "Nav 2"               "Nav 1"              
[16] "Exit East"           "Exit South"          "Exit North"         
[19] "Nav E"               "Don Limpet Preserve" "Tuna Shelf"         
[22] "Makara Shoal"        "Silent Sanctuary"    "Cod Table"          
[25] "Ghoti Preserve"      "Wrasse Beds"         "Nemo Reef"          </code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Because later we are going to append the coordinates values from <code>oceanuslocations</code> to <code>vessel_movement_data</code>, it is very important for to ensure that the class values in <code>source</code> column of <code>vessel_movement_data</code> is similar to <code>Name</code> column of <code>oceanuslocations</code>.</p>
</div>
</div>
<p>In the code chunk below, gsub() is used to remove “City of” from source column. At the same time, <code>gsub()</code> is used to exclude the extra white space in from of the words.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>vessel_movement_data <span class="ot">&lt;-</span> vessel_movement_data<span class="sc">%&gt;%</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">source =</span> <span class="fu">gsub</span>(<span class="st">"^City of"</span>, <span class="st">""</span>, source)) <span class="sc">%&gt;%</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">source =</span> <span class="fu">gsub</span>(<span class="st">"^</span><span class="sc">\\</span><span class="st">s+"</span>, <span class="st">""</span>, source))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notice that the words “City of” have been remove from all records in <code>source</code> column from <code>vessel_movement_data</code> data.frame as shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(vessel_movement_data<span class="sc">$</span>source)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Haacklee"            "Lomark"              "Himark"             
 [4] "Paackland"           "South Paackland"     "Port Grove"         
 [7] "Exit West"           "Nav 3"               "Nav D"              
[10] "Nav B"               "Nav A"               "Nav C"              
[13] "Nav 2"               "Nav 1"               "Exit East"          
[16] "Exit South"          "Exit North"          "Nav E"              
[19] "Cod Table"           "Ghoti Preserve"      "Wrasse Beds"        
[22] "Nemo Reef"           "Don Limpet Preserve" "Tuna Shelf"         </code></pre>
</div>
</div>
</section>
<section id="further-data-wrangling" class="level3">
<h3 class="anchored" data-anchor-id="further-data-wrangling"><strong>Further Data Wrangling</strong></h3>
<p>In the code chunk below, <code>st_coordinate()</code> of <strong>sf</strong> package is used to extract coordinates from <code>oceanuslocations</code> sf data.frame.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(oceanuslocations)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, code chunk below is used to drop the <em><code>geometry</code></em> column of <em><code>oceanuslocations</code></em> sf data.frame by using <code>st_drop_geometry()</code> of <strong><code>sf</code></strong> package and save the output into a new data.frame called <em><code>oceanuslocations_df</code></em>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>oceanuslocations_df <span class="ot">&lt;-</span> oceanuslocations <span class="sc">%&gt;%</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_drop_geometry</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then, the code chunk below is to append the x- and y-coodinate values from coords list into the <code>XCOORD</code> and <code>YCOORD</code> columns of <code>oceanuslocations_df</code> respectively.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>oceanuslocations_df<span class="sc">$</span>XCOORD <span class="ot">&lt;-</span> coords[, <span class="st">"X"</span>]</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>oceanuslocations_df<span class="sc">$</span>YCOORD <span class="ot">&lt;-</span> coords[, <span class="st">"Y"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In the code chunk below, <code>class()</code> is used to confirm that the output is indeed a data.frame.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(oceanuslocations_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "data.frame"</code></pre>
</div>
</div>
<p>Lastly, the code chunk below is used to tidy <code>oceanuslocations_df</code> by selecting the necessary columns only and at the same time, rename <code>X.Kind</code> to <code>loc_type</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>oceanuslocations_df <span class="ot">&lt;-</span> oceanuslocations_df <span class="sc">%&gt;%</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Name, type, X.Kind, XCOORD, YCOORD) <span class="sc">%&gt;%</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">loc_type =</span> X.Kind)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In the code chunk below, <code>left_join()</code> of <code>dplyr</code> package is used to append columns in <code>oceanuslocations_df</code> data.frame to <code>vessel_movement_data</code> data.frame by matching the <code>source</code> column <code>vessel_movement_data</code> data.frame and the <code>Name</code> column from <code>oceanuslocations_df</code> data.frame.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>vessel_movement_data <span class="ot">&lt;-</span> vessel_movement_data <span class="sc">%&gt;%</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(oceanuslocations_df,</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"source"</span> <span class="ot">=</span> <span class="st">"Name"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, this newly updated <code>vessel_movement_data</code> data.frame will be saved to a physical <code>vessel_movement_data.rds</code> file</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(vessel_movement_data, <span class="st">"data/rds/vessel_movement_data.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="creating-vessel-trajectory-data" class="level3">
<h3 class="anchored" data-anchor-id="creating-vessel-trajectory-data">Creating Vessel Trajectory Data</h3>
<p>Now it is time to convert the <em>vessel movement data</em> into <em>vessel trajectory data</em>. A trajectory is a sequence of observations in time and space, for examples, the path formed by fishing vessels.</p>
<p>In the code chunk below, <code>st_as_sf()</code> of <strong>sf</strong> package is used to convert <em><code>vessel_movement_data</code></em> data.frame into <code>sf</code> point data.frame by using values in <code>XCOORD</code> and <code>YCOORD</code> columns. The output is an <code>sf</code> data.frame called <em><code>vessel_movement_sf</code></em>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>vessel_movement_sf <span class="ot">&lt;-</span> vessel_movement_data <span class="sc">%&gt;%</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>(<span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"XCOORD"</span>, <span class="st">"YCOORD"</span>), </span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">crs =</span> <span class="dv">4326</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next <code>arrange()</code> is used to sort the records according to the vessels’ name (i.e.&nbsp;target) and navigation time (i.e.&nbsp;time)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>vessel_movement_sf <span class="ot">&lt;-</span> vessel_movement_sf <span class="sc">%&gt;%</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(target, time)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Lastly, <code>st_cast()</code> of <strong>sf</strong> package is used to convert <em>vessel_movement_sf</em> from point features into linestring features called <em>vessel_trajectory</em>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>vessel_trajectory <span class="ot">&lt;-</span> vessel_movement_sf <span class="sc">%&gt;%</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(target) <span class="sc">%&gt;%</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">do_union =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_cast</span>(<span class="st">"LINESTRING"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(vessel_trajectory)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 296
Columns: 2
$ target   &lt;chr&gt; "albacoreangler47d", "albacoreassaulter482", "amberjackassaul…
$ geometry &lt;LINESTRING [°]&gt; LINESTRING (-164.5496 39.11..., LINESTRING (-164.3…</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(vessel_trajectory)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 296
Columns: 2
$ target   &lt;chr&gt; "albacoreangler47d", "albacoreassaulter482", "amberjackassaul…
$ geometry &lt;LINESTRING [°]&gt; LINESTRING (-164.5496 39.11..., LINESTRING (-164.3…</code></pre>
</div>
</div>
<p>Now that I have the required vessel trajectory data, I need to find out which vessels belong to “SouthSeafood Express Corp”.</p>
</section>
</section>
<section id="lets-begin-the-investigation" class="level2">
<h2 class="anchored" data-anchor-id="lets-begin-the-investigation">Let’s begin the investigation!</h2>
<section id="investigate-type-column-from-the-nodes-data" class="level4">
<h4 class="anchored" data-anchor-id="investigate-type-column-from-the-nodes-data">Investigate ‘type’ column from the nodes data</h4>
<p>Next, I will use the <code>unique()</code> function from the base R package to see all the distinct entries in the <code>type</code> column of the <code>mc2_nodes_cleaned</code> data.frame.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(mc2_nodes_cleaned<span class="sc">$</span>type)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Entity.Commodity.Fish"          "Entity.Location.City"          
 [3] "Entity.Document.DeliveryReport" "Entity.Vessel.FishingVessel"   
 [5] "Entity.Vessel.Other"            "Entity.Vessel.Ferry.Passenger" 
 [7] "Entity.Vessel.CargoVessel"      "Entity.Vessel.Ferry.Cargo"     
 [9] "Entity.Vessel.Research"         "Entity.Vessel.Tour"            
[11] "Entity.Location.Point"          "Entity.Location.Region"        </code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Observation">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Observation
</div>
</div>
<div class="callout-body-container callout-body">
<p>The <code>type</code> column from the nodes data seems to contain a mix of information. Some of the entries appear interesting and useful for analysis, including:</p>
<ul>
<li><p>Entity.Commodity.Fish</p></li>
<li><p>Entity.Document.DeliveryReport</p></li>
<li><p>Entity.Location.City</p></li>
<li><p>Entity.Location.Point</p></li>
<li><p>Entity.Location.Region</p></li>
<li><p>Entity.Vessel.CargoVessel</p></li>
<li><p>Entity.Vessel.FishingVessel</p></li>
</ul>
<p>The other entries seem useless.</p>
</div>
</div>
<p>Next, I will try to find out the count of each entry. The code chunk below allows me to see the count of unique value in each entry.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>nodes_type_counts <span class="ot">&lt;-</span> mc2_nodes_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(type) <span class="sc">%&gt;%</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>())</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the result</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(nodes_type_counts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 2
   type                           count
   &lt;chr&gt;                          &lt;int&gt;
 1 Entity.Commodity.Fish             10
 2 Entity.Document.DeliveryReport  5307
 3 Entity.Location.City               6
 4 Entity.Location.Point             12
 5 Entity.Location.Region             6
 6 Entity.Vessel.CargoVessel        100
 7 Entity.Vessel.Ferry.Cargo          2
 8 Entity.Vessel.Ferry.Passenger      3
 9 Entity.Vessel.FishingVessel      178
10 Entity.Vessel.Other                5
11 Entity.Vessel.Research             2
12 Entity.Vessel.Tour                 6</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Observation">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Observation
</div>
</div>
<div class="callout-body-container callout-body">
<p>Based on the table above, we can see that there are:</p>
<ul>
<li><p>10 Fish Types.</p></li>
<li><p>5307 Delivery Reports.</p></li>
<li><p>6 City Names</p></li>
<li><p>12 Point Locations</p></li>
<li><p>6 Region Locations</p></li>
<li><p>100 Cargo Vessels.</p></li>
<li><p>178 Fishing Vessels.</p></li>
</ul>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter fishing vessels and rename specific columns while keeping all others</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>fishing_vessel <span class="ot">&lt;-</span> mc2_nodes_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Entity.Vessel.FishingVessel"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">fishing_vessel_id =</span> id,</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">fishing_vessel_name =</span> Name</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(fishing_vessel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 178
Columns: 14
$ type                 &lt;chr&gt; "Entity.Vessel.FishingVessel", "Entity.Vessel.Fis…
$ name                 &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ fishing_vessel_id    &lt;chr&gt; "wavewranglerc2d", "yellowfintunataker08b", "arct…
$ fishing_vessel_name  &lt;chr&gt; "Wave Wrangler", "Yellowfin Tuna Taker", "Arctic …
$ Description          &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ Activities           &lt;chr&gt; "NULL", "NULL", "NULL", "NULL", "NULL", "NULL", "…
$ kind                 &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ qty_tons             &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ date                 &lt;dttm&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
$ flag_country         &lt;chr&gt; "Oceanus", "Oceanus", "Oceanus", "Oceanus", "Ocea…
$ company              &lt;chr&gt; "Roth, Logan and Moreno", "Brown-Haas", "Smith, D…
$ tonnage              &lt;int&gt; 700, 4500, 1500, 400, 300, 7400, 100, 6500, 600, …
$ length_overall       &lt;int&gt; 110, 110, 80, 60, 50, 130, 10, 90, 70, 120, 110, …
$ fish_species_present &lt;chr&gt; "NULL", "NULL", "NULL", "NULL", "NULL", "NULL", "…</code></pre>
</div>
</div>
<p>After creating a new data.frame called <code>fishing_vessel</code> to isolate fishing vessel information, I want to find out which of these fishing vessels are registered under “SouthSeafood Express Corp”.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter fishing vessels registered under "SouthSeafood Express Corp"</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>southseafood_fishing_vessels <span class="ot">&lt;-</span> fishing_vessel <span class="sc">%&gt;%</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(company <span class="sc">==</span> <span class="st">"SouthSeafood Express Corp"</span>)</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the result</span></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(southseafood_fishing_vessels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 14
  type  name  fishing_vessel_id fishing_vessel_name Description Activities kind 
  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;             &lt;chr&gt;               &lt;chr&gt;       &lt;chr&gt;      &lt;chr&gt;
1 Enti… &lt;NA&gt;  snappersnatcher7… Snapper Snatcher    &lt;NA&gt;        NULL       &lt;NA&gt; 
2 Enti… &lt;NA&gt;  roachrobberdb6    Roach Robber        &lt;NA&gt;        NULL       &lt;NA&gt; 
# ℹ 7 more variables: qty_tons &lt;dbl&gt;, date &lt;dttm&gt;, flag_country &lt;chr&gt;,
#   company &lt;chr&gt;, tonnage &lt;int&gt;, length_overall &lt;int&gt;,
#   fish_species_present &lt;chr&gt;</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Observation">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Observation
</div>
</div>
<div class="callout-body-container callout-body">
<p>The fishing vessels belonging to “SouthSeafood Express Corp” are:</p>
<ul>
<li><p>Snapper Snatcher (<code>snappersnatcher7be</code>)</p></li>
<li><p>Roach Robber (<code>roachrobberdb6</code>)</p></li>
</ul>
</div>
</div>
</section>
<section id="visualising-the-geo-temporal-patterns-of-the-vessels" class="level3">
<h3 class="anchored" data-anchor-id="visualising-the-geo-temporal-patterns-of-the-vessels">Visualising the Geo-Temporal Patterns of the Vessels</h3>
<p>After identifying the vessels belonging to “SouthSeafood Express Corp,” I will visualize the geo-temporal patterns of the vessels “Snapper Snatcher” and “Roach Robber.”</p>
<p>Let’s start with “Snapper Snatcher.” The code chunk below selects and isolates the appropriate data records belonging to “Snapper Snatcher” using their vessel ID, <code>snappersnatcher7be</code>, located within the target column in the <code>vessel_trajectory</code> data.frame. The result will be stored in a new data.frame called <code>snapsnatch_trajectory</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>snapsnatch_trajectory <span class="ot">&lt;-</span> vessel_trajectory <span class="sc">%&gt;%</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(target <span class="sc">==</span> <span class="st">"snappersnatcher7be"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, the appropriate functions of <code>ggplot2</code> is used to plot the selected vessel “Snapper Snatcher” trajectories by using the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the data</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plot the base map using oceanusgeography</span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> oceanusgeography) <span class="sc">+</span></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>   <span class="co"># Plot the trajectory as LINESTRING for the selected vessel</span></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> snapsnatch_trajectory, </span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>          <span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(target)), </span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plot the individual points for the selected vessel</span></span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> vessel_movement_sf <span class="sc">%&gt;%</span> <span class="fu">filter</span>(target <span class="sc">==</span> <span class="st">"snappersnatcher7be"</span>), </span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a>          <span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(target)), </span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a>          <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb83-17"><a href="#cb83-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-18"><a href="#cb83-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add labels to the individual points</span></span>
<span id="cb83-19"><a href="#cb83-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf_text</span>(<span class="at">data =</span> vessel_movement_sf <span class="sc">%&gt;%</span> <span class="fu">filter</span>(target <span class="sc">==</span> <span class="st">"snappersnatcher7be"</span>), </span>
<span id="cb83-20"><a href="#cb83-20" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">label =</span> source, <span class="at">geometry =</span> geometry), </span>
<span id="cb83-21"><a href="#cb83-21" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">3</span>, </span>
<span id="cb83-22"><a href="#cb83-22" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb83-23"><a href="#cb83-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Trajectories of Snapper Snatcher"</span>, </span>
<span id="cb83-24"><a href="#cb83-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="st">"Longitude"</span>, <span class="at">y =</span> <span class="st">"Latitude"</span>, <span class="at">color =</span> <span class="st">"ID"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Observation">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Observation
</div>
</div>
<div class="callout-body-container callout-body">
<p>From the observations above, it is evident that Snapper Snatcher visited and dwelled at Ghoti Preserve, an ecological site not intended for fishing. This behavior is definitely suspicious.</p>
</div>
</div>
<p>Now let’s do the same for the second “SouthSeafood Express Corp” vessel, which is “Roach Robber” with the vessel ID <code>roachrobberdb6</code> and store the data in <code>roachrob_trajectory</code> data.frame.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>roachrob_trajectory <span class="ot">&lt;-</span> vessel_trajectory <span class="sc">%&gt;%</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(target <span class="sc">==</span> <span class="st">"roachrobberdb6"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, the appropriate functions of <code>ggplot2</code> is used to plot the selected vessel “Roach Robber” trajectories by using the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the data</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plot the base map using oceanusgeography</span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> oceanusgeography) <span class="sc">+</span></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>   <span class="co"># Plot the trajectory as LINESTRING for the selected vessel</span></span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> roachrob_trajectory, </span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>          <span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(target)), </span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plot the individual points for the selected vessel</span></span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> vessel_movement_sf <span class="sc">%&gt;%</span> <span class="fu">filter</span>(target <span class="sc">==</span> <span class="st">"roachrobberdb6"</span>), </span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a>          <span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(target)), </span>
<span id="cb85-16"><a href="#cb85-16" aria-hidden="true" tabindex="-1"></a>          <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb85-17"><a href="#cb85-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb85-18"><a href="#cb85-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add labels to the individual points</span></span>
<span id="cb85-19"><a href="#cb85-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf_text</span>(<span class="at">data =</span> vessel_movement_sf <span class="sc">%&gt;%</span> <span class="fu">filter</span>(target <span class="sc">==</span> <span class="st">"roachrobberdb6"</span>), </span>
<span id="cb85-20"><a href="#cb85-20" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">label =</span> source, <span class="at">geometry =</span> geometry), </span>
<span id="cb85-21"><a href="#cb85-21" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">3</span>, </span>
<span id="cb85-22"><a href="#cb85-22" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb85-23"><a href="#cb85-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Trajectories of Roach Robber"</span>, </span>
<span id="cb85-24"><a href="#cb85-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="st">"Longitude"</span>, <span class="at">y =</span> <span class="st">"Latitude"</span>, <span class="at">color =</span> <span class="st">"ID"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Observation">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Observation
</div>
</div>
<div class="callout-body-container callout-body">
<p>From the observations above, it is appears that Roach Robber does not frequent any of the ecological preserve. No suspicious activity can be found.</p>
</div>
</div>
</section>
</section>
<section id="reference" class="level2">
<h2 class="anchored" data-anchor-id="reference"><strong>Reference</strong></h2>
<ul>
<li><p>Prof.&nbsp;Kam. <a href="https://isss608-ay2023-24apr.netlify.app/vast/kickstarter2"><strong>Kickstarter2</strong></a></p></li>
<li><p>Prof.&nbsp;Kam. <a href="https://isss608-ay2023-24apr.netlify.app/vast/kickstarter3"><strong>Kickstarter3</strong></a></p></li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>